<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Storm Events around Australia â€” Infographics</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  <style>
    :root{
      --bg:#0b1020; --ink:#e9eef7; --ink-dim:#c7cfda; --accent:#9bd;
      --card:#0e152b; --divider:#26324a;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif}
    a{color:var(--accent)}
    .wrap{max-width:1200px;margin:0 auto;padding:0 16px}
    header.hero{padding:28px 0 10px;text-align:center}
    .eyebrow{letter-spacing:.1em;text-transform:uppercase;font-size:12px;opacity:.8}
    h1{font-size:28px;margin:.2rem 0 .35rem}
    .sub{opacity:.9;margin:0 auto 10px;font-size:14px}
    
    .grid{display:grid;gap:18px;margin:18px auto}
    .card{background:var(--card);border:1px solid var(--divider);border-radius:16px;padding:18px 22px;}
    .card h2{font-size:18px;margin:4px 0 12px; border-bottom: 1px solid var(--divider); padding-bottom: 8px;}
    .vis{width:100%; height:75vh} 
    .smallvis{width:100%; height:400px}
    
    .prose{max-width:800px; margin:22px auto;}
    .prose h2{font-size:20px;}
    .prose p{margin:0;color:var(--ink-dim);line-height:1.7; font-size: 16px;}

    .explanation { 
        padding: 12px 4px 4px; 
        font-size: 15px;
        color: var(--ink-dim); 
        line-height: 1.7; 
        max-width: 800px;
    }
    .explanation strong { 
        color: var(--ink); 
        font-weight: 600; 
    }

    footer{border-top:1px solid var(--divider);margin:24px auto 30px;padding-top:14px}
    .source{font-size:12px;opacity:.85}
    .pill{display:inline-block;border:1px solid var(--divider);padding:2px 8px;border-radius:9999px;font-size:12px;opacity:.9}
  </style>
</head>
<body>
  <header class="hero wrap">
    <div class="eyebrow">FIT3179</div>
    <h1>Understanding Severe Storms in Australia</h1>
    <p class="sub">An interactive dashboard exploring severe storm events across the continent.</p>
  </header>

  <main class="wrap">
    
    <section class="prose">
        <h2>Why Study Storm Patterns?</h2>
        <p>
            Severe weather events pose significant risks to communities and infrastructure. By analyzing historical storm data,
            we can identify patterns and pinpoint areas that are most frequently affected. This knowledge is crucial for
            developing targeted strategies for weather reinforcement, improving public safety, and building more resilient
            communities. This dashboard provides an initial exploration into that data.
        </p>
    </section>

    <section class="grid">
      <article class="card">
        <h2>Geographic Distribution of Storm Events</h2>
        <div id="map" class="vis"></div>
        <div class="explanation">
          This map plots the location of every recorded storm event.
          <br><br>
          An immediate insight is the high concentration of events along the populous <strong>East and South-West coasts</strong>, which is highlighted with an annotation. This suggests a strong correlation between population density and the number of reported storms.
        </div>
      </article>

      <article class="card">
        <h2>Which Events Are Most Common?</h2>
        <div id="bars" class="smallvis"></div>
        <div class="explanation">
          This chart aggregates the total number of events by type. It clearly shows that <strong>heavy rain</strong> is the most frequently recorded severe weather event in the archive, occurring significantly more often than wind or hail. Lightning appears to be the least-reported event.
        </div>
      </article>

      <article class="card">
        <h2>Are Storms Becoming More Frequent?</h2>
        <div id="timeline" class="smallvis"></div>
         <div class="explanation">
          This timeline tracks the total number of severe storm events recorded each year from 2010 to 2021. The data reveals significant year-to-year fluctuation rather than a steady trend, typical of complex weather patterns. The period begins with one of the most active years, 2010, followed by a sharp decline to the lowest point in 2013. Afterward, event numbers climbed again, peaking in 2017 before trending downwards in the most recent years shown. The spike around 2017-2018 represents the most active period within the latter half of this dataset.
        </div>
      </article>
    </section>

    <footer class="source">
      <span class="pill">Sources</span>
      <div style="margin-top:8px">
        ABS: <em>ASGS 2021 digital boundary files</em>. data.gov.au listing.
        BoM: <em>Severe Storms Archive</em>.
        Projection notes: Vega/Vega-Lite docs & EPSG:3577.
      </div>
    </footer>
  </main>

<script>
/* ---------- Shared config ---------- */
const sharedConfig = {
  background: "#0b1020",
  legend: { labelColor:"#ffffff", titleColor:"#ffffff", labelFontSize:13, titleFontSize:15, symbolSize:220 },
  axis: { labelColor:"#e9eef7", titleColor:"#e9eef7", gridColor: "#26324a" },
  view: { stroke:null },
  title: { color: "#ffffff", subtitleColor: "#c7cfda" },
  text: { color: "#ffffff" }
};

// Define the custom color scheme once to reuse it
const eventColorScale = {
  domain: ["Hail", "Lightning", "Rain", "Tornado", "Waterspout", "Wind"],
  range: ["#a6cee3", "#fee08b", "#1f78b4", "#888888", "#fdbf6f", "#33a02c"]
};


/* ============== MAP ============== */
const mapSpec = {
  "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
  width: "container",
  height: "container",
  autosize: {"type":"fit", "contains":"padding", "resize": true},
  config: sharedConfig,
  projection: { "type":"albers", "parallels":[-18,-36], "rotate": [-132, 0, 0] },
  layer: [
    {
      data: { "url":"data/aus_2021_3.json", "format":{"type":"topojson", "feature":"AUS_2021_AUST_GDA94"} },
      mark:{ "type":"geoshape", "fill":"#ffffff", "fillOpacity":0.10, "stroke":"#ffffff", "strokeWidth":1.1 }
    },
    {
      data: { "url":"data/aus_2021_3.json", "format":{"type":"topojson", "mesh":"STE_2021_AUST_GDA94"} },
      mark:{ "type":"geoshape", "stroke":"#ffffff", "strokeWidth":0.9, "fillOpacity":0 }
    },
    {
      data:{ "url":"data/stormarchive.csv" },
      params: [
        {
          "name": "typeSel",
          "select": { "type": "point", "fields": ["Database"] },
          "bind": "legend",
          "clear": "dblclick"
        }
      ],
      transform:[
        { "calculate":"toNumber(datum.Longitude)", "as":"lon"},
        { "calculate":"toNumber(datum.Latitude)",  "as":"lat"},
        { "filter":"isValid(datum.lon) && isValid(datum.lat)"},
        { "filter":"datum.lon >= 110 && datum.lon <= 155 && datum.lat >= -45 && datum.lat <= -8"},
        { "filter": "length(data('typeSel_store')) == 0 || vlSelectionTest('typeSel_store', datum)"}
      ],
      mark:{ "type":"circle", "filled":true },
      encoding:{
        "longitude":{"field":"lon", "type":"quantitative"},
        "latitude":{"field":"lat", "type":"quantitative"},
        "color":{ 
          "field":"Database", "type":"nominal", "legend":{"title":"Event Type"}, "scale": eventColorScale
        },
        "size":{ "value":48 },
        "opacity": { "value": 0.95 },
        "tooltip":[
          {"field":"Database", "title":"Type"},
          {"field":"Nearest town", "title":"Nearest town"},
          {"field":"State"},
          {"field":"Date/Time", "title":"Date/Time"},
          {"field":"Latitude", "type":"quantitative", "format":".3f"},
          {"field":"Longitude", "type":"quantitative", "format":".3f"},
          {"field":"Comments"}
        ]
      }
    },
    {
      "data": { "values": [ {"lon": 150, "lat": -39, "note": "High event density\nalong East coast"} ] },
      "mark": { "type": "text", "color": "#c7cfda", "fontStyle": "bold", "fontSize": 14, "align": "left", "lineBreak": "\n" },
      "encoding": {
        "longitude": {"field": "lon", "type": "quantitative"},
        "latitude": {"field": "lat", "type": "quantitative"},
        "text": {"field": "note"}
      }
    }
  ]
};

/* ============== CHART 1: Bar chart ============== */
const barsSpec = {
  "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
  width:"container", height:"container",
  autosize:{type:"fit", "contains":"padding", "resize": true},
  config: sharedConfig,
  data:{ "url":"data/stormarchive.csv" },
  layer: [
    {
      "encoding":{
        "y":{ "field":"Database", "type":"nominal", "title":null, "sort":"-x" },
        "x":{ "aggregate":"count", "type":"quantitative", "title":"Count" },
        "tooltip":[ {"field":"Database", "title":"Event Type"}, {"aggregate":"count", "title":"Count"} ]
      },
      "layer": [
        {
          "mark": "bar",
          "encoding": { "color":{ "field":"Database", "type":"nominal", "legend":null, "scale": eventColorScale } }
        },
        {
          "mark": { "type": "text", "align": "left", "baseline": "middle", "dx": 3, "color": "#e9eef7"},
          "encoding": { "text": { "aggregate": "count", "type": "quantitative", "format": "," } }
        }
      ]
    },
    {
      "data": {"values": [{}]},
      "mark": {
        "type": "text",
        "align": "right",
        "x": "width",
        "y": 200,
        "dx": -100,
        "fontSize": 16,
        "fontStyle": "italic",
        "color": "#e9eef7",
        "lineBreak": "\n",
        "text": "This chart shows the total count\nof storms for each event type."
      }
    }
  ]
};

/* ============== CHART 2: Timeline ============== */
const timeSpec = {
  "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
  width:"container", height:"container",
  autosize:{type:"fit", "contains":"padding", "resize": true},
  config: sharedConfig,
  "data": {
    "url": "data/stormarchive.csv",
    "format": {
      "type": "csv",
      "parse": {"Date/Time": "date:'%d/%m/%Y %H:%M'"}
    }
  },
  layer: [
    {
      "transform": [
        {"timeUnit": "year", "field": "Date/Time", "as": "year"}
      ],
      "encoding":{
        "x":{ "field":"year", "type":"temporal", "title":"Year", "axis": {"format": "%Y"} },
        "y":{ "aggregate":"count", "type":"quantitative", "title":"Events" },
        "tooltip":[ {"field":"year", "type":"temporal", "title":"Year", "format": "%Y"}, {"aggregate":"count", "title":"Events"} ]
      },
      "layer": [
        { "mark": {"type":"line", "color":"#9bd"} },
        { "mark": {"type":"circle", "color":"#9bd", "size": 60} }
      ]
    },
    {
      transform: [
        { "aggregate": [{"op": "count", "as": "total"}] },
        { "calculate": "'Total Events: ' + format(datum.total, ',')", "as": "text_annotation" }
      ],
      "mark": {
        "type": "text",
        "align": "right",
        "x": "width",
        "y": 50,
        "dx": -450,
        "dy": 15,
        "fontSize": 14,
        "fontStyle": "italic",
        "color": "#c7cfda"
      },
      "encoding": {
        "text": {"field": "text_annotation", "type": "nominal"}
      }
    }
  ]
};

/* Embed main visuals */
vegaEmbed("#map", mapSpec, {actions:false});
vegaEmbed("#bars", barsSpec, {actions:false});
vegaEmbed("#timeline", timeSpec, {actions:false});

</script>
</body>
</html>